%% lecture-personal-extra-code.sty
%%
%% --------------------------------------------------------------------------
%%
%% Autor: Florian Sihler, 3.11.2020
%%
%% code environment

\ProvidesPackage{lecture-personal-extra-code}[2020/12/08 v1.0 Personal code]

\PassOptionsToPackage{chapterlistsgap=\medskipamount}{newfloat}
\RequirePackage{newfloat}

\DeclareFloatingEnvironment[%
fileext=loc,listname={Alle Listings},name=Listing,placement=tbp,within=none,%
]{code}

% patch to bridge for lithie boxe
\def\listofcodes{\bgroup%
\def\contentsname{Alle Listings}% may?
\libx@listof@heading{\contentsname}%
\let\numberline\libx@list@numberformat% right align by boxes
\libx@starttoc{loc}%
\egroup}
% modifx code styles to match box

\newlength\cftcodenumwidth
\cftcodenumwidth=\dimexpr\libx@numwidth+\libx@numwidth@offset\relax

\gdef\l@code#1#2{\@dottedtocline{1}{\cftcodenumwidth}{\cftcodenumwidth}{#1}{#2}}%

\AppendToProfile{print}{%
\AtBeginEnvironment{code}{\lstfs{10}}%
\AtBeginEnvironment{code*}{\lstfs{10}}%
\@ifpackageloaded{sopra-listings}{\lstset{lineskip=3pt}}{}%
}

\AppendToProfile{mobile}{%
\AtBeginEnvironment{code}{\lstfs{11}}%
\AtBeginEnvironment{code*}{\lstfs{11}}%
\@ifpackageloaded{sopra-listings}{%
  \colorlet{sol@colors@border}{sol@colors@background}%
  %\colorlet{sol@colors@background}{white!0}%
  \lstset{lineskip=3.25pt}%
}{}%
}

\endinput